---
title: Integrate Discord with Web3Auth
image: "guides-banners/discord.png"
description: Learn how to use Web3Auth for Discord login using Social Connections.
type: guide
tags: [web, discord, evm]
keywords: [discord login, discordapp login, discord, custom authentication, react, ethereum, solana]
date: July 18, 2022
author: Web3Auth Team
communityPortalTopicId: 48
---

import DiscordSetup from "@site/src/common/guides/_discord-setup.mdx";
import SetupWeb3AuthDashboard from "@site/src/common/guides/_setup-web3auth-dashboard.mdx";
import Web3AuthPrerequisites from "@site/src/common/guides/_web3auth-prerequisites.mdx";
import SEO from "@site/src/components/SEO";
import DiscordToggle from "@site/static/images/dashboard/authentication-social-connections.png";
import DiscordConnection from "@site/static/images/dashboard/discord-connection.png";

<SEO
  title="Integrate Discord with Web3Auth"
  description="This guide will cover the basics of how to set up Web3Auth with Discord Login and provide steps on how to develop a basic web application on the Ethereum blockchain."
  image="https://web3auth.io/docs/guides-banners/discord.png"
  slug="/guides/discord"
/>

This guide will cover the basics of how to set up Web3Auth with Discord Login and provide steps on
how to develop a basic web application on the Ethereum blockchain.

**Live Demo:** https://web3auth-core-discord-demo.vercel.app

## Quick Start

```bash
npx degit Web3Auth/web3auth-pnp-examples/web-modal-sdk/custom-authentication/single-connection/discord-implicit-example w3a-discord-demo && cd w3a-discord-demo && npm install && npm run dev
```

## How it works?

When integrating Web3Auth with Discord Login the flow looks something like this:

![Web3Auth Core - Discord Login Flow](/images/implicit-flow.svg)

- When a user logs in with `Discord`, Discord sends a JWT `id_token` to the app. This JWT token is
  sent to the Web3Auth SDK's login function.

- Finally, on successful validation of the JWT token, Web3Auth will generate a private key for the
  user, in a self-custodial way, resulting in easy onboarding for your user to the application.

## Prerequisites

<Web3AuthPrerequisites />

- A [Discord Developer](https://discord.com/developers/applications) account to be used as Login
  provider for Web3Auth authentication.

## Setup

### Setup your Discord App

<DiscordSetup />

### Setup your Web3Auth Dashboard

<SetupWeb3AuthDashboard />

### Create a Discord Connection

Follow these steps to create a Discord connection:

1. Visit the [Web3Auth Dashboard](https://dashboard.web3auth.io).
2. Go to the `Social Connections` section.
3. Click on the `Settings` icon near the Discord connection.
4. Enter the `Auth Connection ID` (e.g., "w3a-discord-demo").
5. Enter the `Discord Client ID` you obtained from the Discord Developer dashboard.
6. Finally, click on the `Add Connection` button.

<div style={{ display: "flex", margin: "20px 0" }}>
  <img
    src={DiscordConnection}
    style={{
      maxWidth: "600px",
      borderRadius: "8px",
      boxShadow: "0 2px 6px rgba(0, 0, 0, 0.1)",
    }}
    alt="Discord Connection"
  />
</div>

## Using the Web3Auth SDK

To use the Web3Auth SDK, you need to add the dependency of the respective platform SDK of Web3Auth
to your project. To know more about the available SDKs, please have a look at this
[documentation page](/sdk).

For this guide, we will be using the Web3Auth Modal SDK with React hooks.

### Installation

Install the required Web3Auth packages:

```bash
npm install @web3auth/modal
```

For interacting with Ethereum blockchain:

```bash
npm install wagmi viem @tanstack/react-query
```

### Setting up Web3Auth in React

We need to set up the Web3Auth context configuration:

```tsx title="src/web3authContext.tsx"
import { WEB3AUTH_NETWORK, type Web3AuthOptions } from "@web3auth/modal";

// Get client ID from https://dashboard.web3auth.io
const clientId = import.meta.env.VITE_WEB3AUTH_CLIENT_ID;

// Instantiate SDK
const web3AuthOptions: Web3AuthOptions = {
  clientId,
  web3AuthNetwork: WEB3AUTH_NETWORK.SAPPHIRE_MAINNET,
  authBuildEnv: "testing",
};

const web3AuthContextConfig = {
  web3AuthOptions,
};

export default web3AuthContextConfig;
```

Then, wrap your application with the Web3Auth provider and Wagmi provider:

```tsx title="src/index.tsx"
import "./index.css";

import ReactDOM from "react-dom/client";
// Setup Web3Auth Provider
import { Web3AuthProvider } from "@web3auth/modal/react";
import web3AuthContextConfig from "./web3authContext";
// Setup Wagmi Provider
import { WagmiProvider } from "@web3auth/modal/react/wagmi";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";

import App from "./App";

const queryClient = new QueryClient();

const root = ReactDOM.createRoot(document.getElementById("root") as HTMLElement);
root.render(
  // Setup Web3Auth Provider
  <Web3AuthProvider config={web3AuthContextConfig}>
    {/* Setup Wagmi Provider */}
    <QueryClientProvider client={queryClient}>
      <WagmiProvider>
        <App />
      </WagmiProvider>
    </QueryClientProvider>
  </Web3AuthProvider>,
);
```

### Authentication

In your main application component, use Web3Auth hooks for authentication:

```tsx title="src/App.tsx"
import "./App.css";
import { useWeb3AuthConnect, useWeb3AuthDisconnect, useWeb3AuthUser } from "@web3auth/modal/react";
import { WALLET_CONNECTORS, AUTH_CONNECTION } from "@web3auth/modal";
import { useAccount } from "wagmi";
import { SendTransaction } from "./components/sendTransaction";
import { Balance } from "./components/getBalance";
import { SwitchChain } from "./components/switchNetwork";

function App() {
  const { connectTo, isConnected, connectorName } = useWeb3AuthConnect();
  const { disconnect } = useWeb3AuthDisconnect();
  const { userInfo } = useWeb3AuthUser();
  const { address } = useAccount();

  const loginWithDiscord = async () => {
    await connectTo(WALLET_CONNECTORS.AUTH, {
      authConnection: AUTH_CONNECTION.DISCORD,
      authConnectionId: "w3a-discord-demo",
    });
  };

  function uiConsole(...args: any[]): void {
    const el = document.querySelector("#console>p");
    if (el) {
      el.innerHTML = JSON.stringify(args || {}, null, 2);
      console.log(...args);
    }
  }

  const loggedInView = (
    <>
      <h2>Connected to {connectorName}</h2>
      <div>{address}</div>
      <div className="flex-container">
        <div>
          <button onClick={() => uiConsole(userInfo)} className="card">
            Get User Info
          </button>
        </div>
        <div>
          <button onClick={() => disconnect()} className="card">
            Log Out
          </button>
        </div>
      </div>
      <SendTransaction />
      <Balance />
      <SwitchChain />
    </>
  );

  const unloggedInView = (
    <div className="flex-container">
      <button onClick={loginWithDiscord} className="card">
        Login with Discord
      </button>
    </div>
  );

  return (
    <div className="container">
      <h1 className="title">
        <a target="_blank" href="https://web3auth.io/docs/sdk/pnp/web/no-modal" rel="noreferrer">
          Web3Auth{" "}
        </a>
        & React with Discord
      </h1>

      <div className="grid">{isConnected ? loggedInView : unloggedInView}</div>
      <div id="console" style={{ whiteSpace: "pre-line" }}>
        <p style={{ whiteSpace: "pre-line" }}></p>
      </div>
    </div>
  );
}

export default App;
```

### Interacting with Blockchain

With the Web3Auth and Wagmi integration, you can easily interact with blockchain. Here are some
examples:

#### Getting Balance

```tsx title="src/components/getBalance.tsx"
import { useAccount, useBalance } from "wagmi";
import { formatUnits } from "viem";

export function Balance() {
  const { address } = useAccount();

  const { data, isLoading, error } = useBalance({ address });

  return (
    <div>
      <h2>Balance</h2>
      <div>
        {data?.value !== undefined && `${formatUnits(data.value, data.decimals)} ${data.symbol}`}{" "}
        {isLoading && "Loading..."} {error && "Error: " + error.message}
      </div>
    </div>
  );
}
```

#### Sending Transactions

```tsx title="src/components/sendTransaction.tsx"
import { FormEvent } from "react";
import { useWaitForTransactionReceipt, useSendTransaction, BaseError } from "wagmi";
import { Hex, parseEther } from "viem";

export function SendTransaction() {
  const { data: hash, error, isPending, sendTransaction } = useSendTransaction();

  async function submit(e: FormEvent<HTMLFormElement>) {
    e.preventDefault();
    const formData = new FormData(e.target as HTMLFormElement);
    const to = formData.get("address") as Hex;
    const value = formData.get("value") as string;
    sendTransaction({ to, value: parseEther(value) });
  }

  const { isLoading: isConfirming, isSuccess: isConfirmed } = useWaitForTransactionReceipt({
    hash,
  });

  return (
    <div>
      <h2>Send Transaction</h2>
      <form onSubmit={submit}>
        <input name="address" placeholder="Address" required />
        <input name="value" placeholder="Amount (ETH)" type="number" step="0.000000001" required />
        <button disabled={isPending} type="submit">
          {isPending ? "Confirming..." : "Send"}
        </button>
      </form>
      {hash && <div>Transaction Hash: {hash}</div>}
      {isConfirming && "Waiting for confirmation..."}
      {isConfirmed && "Transaction confirmed."}
      {error && <div>Error: {(error as BaseError).shortMessage || error.message}</div>}
    </div>
  );
}
```

#### Switching Networks

```tsx title="src/components/switchNetwork.tsx"
import { useChainId, useSwitchChain } from "wagmi";

export function SwitchChain() {
  const chainId = useChainId();
  const { chains, switchChain, error } = useSwitchChain();

  return (
    <div>
      <h2>Switch Chain</h2>
      <h3>Connected to {chainId}</h3>
      {chains.map((chain) => (
        <button
          disabled={chainId === chain.id}
          key={chain.id}
          onClick={() => switchChain({ chainId: chain.id })}
          type="button"
          className="card"
        >
          {chain.name}
        </button>
      ))}

      {error?.message}
    </div>
  );
}
```

## Example code

The code for the application we developed in this guide can be found in the
[Web3Auth Discord Login Example](https://github.com/Web3Auth/web3auth-pnp-examples/tree/main/web-modal-sdk/custom-authentication/single-connection/discord-implicit-example).
Check it out and try running it locally yourself!

## Troubleshoot

### Duplicate token found

:::warning

Receiving `Could not get result from torus nodes Duplicate token found` error when using Discord for
login?

- This is because Discord issues the same token for 30 mins.
- We revoke it for you for default integrations, but in some cases, your application may need to
  handle this.
- The integrating applications might need to revoke the token themselves before attempting the next
  login by using Discord clientId and secret to revoke the token.

:::

Here's the sample code to revoke the token:

```tsx
const axios = require("axios").default;
const FormData = require("form-data");

const { DISCORD_CLIENT_SECRET, DISCORD_CLIENT_ID } = process.env;
const { token } = req.body;
const formData = new FormData();
formData.append("token", token);
await axios.post("https://discord.com/api/oauth2/token/revoke", formData, {
  headers: {
    ...formData.getHeaders(),
    Authorization: `Basic ${Buffer.from(
      `${DISCORD_CLIENT_ID}:${DISCORD_CLIENT_SECRET}`,
      "binary",
    ).toString("base64")}`,
  },
});
```

## Questions?

Ask us on [Web3Auth's Community Support Portal](https://web3auth.io/community)
